# Note: This file is not intended to be edited by the user
# 'floc' (field location) 'ftype' (field type) and 'dtype' (data type)
# are optional items.
# the 'floc' item can be used to provide positioning direction to the form
# placement.
# floc: skipline     (skips a line before placing this item on the form)
# floc: samelinexx  (causes this item to be placed at pos xx on the same line as
#                    the previous field)
# floc: x,y Causes the field to be placed at relx,rely
# The 'ftype' item determines the type of field used. Default is text.
# ftype: file, text, ftext  field type. (file search field, text input field,
#       fixed text) Default is text
# dtype:    determines the type of data checking applied to the field
#           valid dtypes are intm-n, int-or-none, ipv4, ipv4mask
# smart_update: smart_update consists of key value pairs. The key is the name of a
#           method to run in the parent app class. The value is a list of positional
#           arguments (usually the names of other form fields) which are passed to
#           the named method. The method is also passed the field being updated,
#           the form field dictionary and the form definition dictionary and
#           implements the logic needed to update the current field as appropriate.

version: 1.0

# Network configuration
network:
    bmc_vlan_number:
        val: ''
        desc: BMC VLAN number
        help: The BMC VLAN is the VLAN number of the vlan in which the BMC ports
            reside. Power-Up can create a tagged VLAN interface on a physical
            Ethernet interface of this installer node. If using VLANs it is the
            user's responsibility to insure that a port virtual id (pvid) exists
            already on the switch ports to which the BMC ports are connected and
            that the switch port to which the installer node is connected is in
            trunk mode with the BMC VLAN allowed.
        dtype: int-or-none2-4094
        hidden: True
        smart_update:
            show_if_phys_ifc:
                - bmc_ethernet_ifc
                - bmc_subnet
                - bmc_subnet_prefix

    bmc_subnet_prefix:
        val: 255.255.255.0 24
        desc: BMC subnet prefix
        help: Prefix for the BMC subnet. Valid values are integers between 1 and 32.
              The subnet mask is autogenerated from the prefix.
        dtype: ipv4mask

    bmc_subnet:
        val: 192.168.1.0
        desc: BMC subnet
        help: The BMC subnet is the subnet which contains the BMC ports of the
            nodes to be installed. Note that if Power-Up is configured to use
            DHCP for allocating BMC addresses, the entire subnet is assumed to
            be available for use.
        dtype: ipv4
        smart_update:
            mask_ipv4_field:
                - bmc_subnet_prefix

    bmc_ethernet_ifc:
        val:
        desc: BMC Ethernet Ifc
        help: Ethernet port used to access the BMC interfaces. If a route exists
            which matches the BMC subnet, the interface associated with that route is
            is displayed and can not be altered. If a route matching the BMC subnet does
            not exist, a list of 'UP' physical interfaces is presented when you press
            enter. Cursor up or down and press enter to select an interface.
        ftype: eth-ifc
        smart_update:
            get_ifc_from_route:
                - bmc_subnet
                - bmc_subnet_prefix

    bmc_address_mode:
        val: dhcp
        values:
            - dhcp
            - static
        desc: BMC address mode
        help: If static is selected, existing ipv4 addresses will be used and unchanged.
            If dhcp is selected, PowerUp will setup a DHCP server on this node in
            the subnet specified in 'BMC subnet'
        ftype: select-one

    pxe_vlan_number:
        val: ''
        desc: PXE VLAN number
        help:
            The PXE VLAN is the VLAN number of the vlan in which the PXE ports
            reside. Power-Up can create a tagged VLAN interface on a physical
            Ethernet interface of this installer node. If using VLANs it is the
            user's responsibility to insure that a port virtual id (pvid) exists
            already on the switch ports to which the BMC ports are connected and
            that the switch port to which the installer node is connected is in
            trunk mode with the PXE VLAN allowed.
        dtype: int-or-none2-4094
        hidden: True
        floc: skipline
        smart_update:
            show_if_phys_ifc:
                - pxe_ethernet_ifc
                - pxe_subnet
                - pxe_subnet_prefix

    pxe_subnet_prefix:
        val: 255.255.255.0 24
        desc: PXE subnet prefix
        help: Prefix for the PXE subnet. Valid values are integers between 1 and 32.
              The subnet mask is autgenerated from the prefix.
        dtype: ipv4mask

    pxe_subnet:
        val: 192.168.2.0
        desc: PXE subnet
        help:
            The PXE subnet is the subnet which contains the PXEs ports of the
            nodes to be installed. Note that if Power-Up is configured to use
            DHCP for allocating PXE addresses, the entire subnet is assumed to
            be available for use.
        dtype: ipv4
        smart_update:
            mask_ipv4_field:
                - pxe_subnet_prefix

    pxe_ethernet_ifc:
        val:
        desc: PXE Ethernet Ifc
        help: Ethernet port used to access the PXE interfaces. If a route exists
            which matches the PXE subnet, the interface associated with that route is
            is displayed and can not be altered. If a route matching the PXE subnet does
            not exist, a list of 'UP' physical interfaces is presented when you press
            enter. Cursor up or down and press enter to select an interface.
        ftype: eth-ifc
        smart_update:
            get_ifc_from_route:
                - pxe_subnet
                - pxe_subnet_prefix

# Node configuration
node:
    bmc_userid:
        val: ADMIN
        desc: BMC userid
        help:
            User ID used to log into the target nodes BMCs. The user ID must
            be the same for all target nodes.

    bmc_password:
        val: admin
        desc: BMC password
        help:
            Password to log into the target nodes BMCs. The password must be
            the same for all target nodes.

    hostname:
        val: compute
        desc: Hostname
        help:
            This is the 'hostname' which will be given to the target nodes.
            Host names will be suffixed with a dash and a number starting
            with 1. ie hostname-1, hostname-2 etc.
        floc: skipline

    domain:
        val: localdomain
        desc: Domain
        help: This is the domain which will be given to the target nodes.

    username:
        val: pupuser
        desc: Username
        help: A user account will be created with this name.

    password:
        val: passw0rd
        desc: Password
        help: This password will be assigned to both root and user accounts.

    iso_image_file:
        val:
        desc: ISO image file
        help:
            Name of the file containing the 'iso' image for the OS to be
            installed.
        ftype: file
        dtype: file-iso
        floc: skipline

    devices_found:
        val:
        desc: Devices found
        help: Number of devices responding to ICMP echo requests
        floc: skipline
        dtype: no-save

    bmcs_found:
        val:
        desc: BMCs found
        help: Number of devices with port 623 open (IPMI)
        dtype: no-save

    node_list_header:
        val: "  SERIAL NUMBER   PART NUMBER        MAC ADDRESS        \
              IP ADDRESS    BMC TYPE"
        desc: node list header
        floc: skipline
        ftype: ftext

    node_list:
        val: []
        values:
            - null
        desc: Node list
        help:
            This field contains the list of discovered nodes on the BMC
            subnet. Nodes in this list respond to OpenBMC or IPMI
            communication protocol. Press space bar or enter to select a node
            for OS installation.
        # floc: skipline
        ftype: select-multi
        dtype: no-save

    scan_for_nodes:
        # val in this case is the x and y coordinates of the button. Negative y values
        # are relative to the bottom of the window
        val:
        desc: Scan for nodes
        #help: Press enter to scan the BMC network for nodes
        ftype: button1,-3
        floc: 1,-3

    edit_networks:
        # val in this case is the x and y coordinates of the button. Negative y values
        # are relative to the bottom of the window
        val:
        desc: Edit network config
        #help: Press enter to scan the BMC network for nodes
        ftype: button25,-3
        floc: 25,-3

# Node installation status table
status:
    installation_image:
        val: null
        desc: OS Image
        help: OS Installation Image File
        ftype: tftext

    pxeboot_status:
        val: Enabled
        desc: PXE Boot
        help: PXE Boot OS Installation Enabled or Disabled
        ftype: tftext
        floc: skipline

    start_time:
        val: null
        desc: Start Time
        help: PXE boot installation start time
        ftype: tftext
        floc: skipline

    nodes_finished:
        val:
        desc: Finished
        help: Total number of nodes reported OS install finished.
        ftype: tftext
        floc: skipline

    node_list_header:
        val: ''
        desc: Detailed node installation status
        help: Detailed node installation status
        floc: skipline

    status_table:
        values: []
        desc: Nodes selected for OS installation
        help: This field contains the list of nodes selected to install OS.
        ftype: pager
        dtype: no-save
